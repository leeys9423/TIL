# 입출력(I/O)

## 입출력(I/O) 기본 개념

**입출력이란**

- **입력(Input)**: 프로그램으로 데이터를 읽어들이는 것
- **출력(Output)**: 프로그램에서 데이터를 내보내는 것
- 파일, 키보드, 모니터, 네트워크 등 다양한 입출력 대상

**스트림(Stream)의 개념**

- 데이터를 운반하는 연결통로
- 단방향 통신만 가능 (입력스트림 따로, 출력스트림 따로)
- FIFO(First In First Out) 구조

## 스트림의 분류

**바이트 기반 스트림 vs 문자 기반 스트림**

- **바이트 스트림**: 바이너리 데이터 처리 (InputStream/OutputStream)
- **문자 스트림**: 텍스트 데이터 처리 (Reader/Writer)

**입력 스트림 vs 출력 스트림**

- **입력 스트림**: 데이터를 읽어오는 스트림
- **출력 스트림**: 데이터를 내보내는 스트림

**노드 스트림 vs 처리 스트림**

- **노드 스트림**: 실제 데이터 소스에 연결되는 스트림
- **처리 스트림**: 다른 스트림을 래핑하여 부가 기능을 제공

## 바이트 기반 스트림

**InputStream의 주요 메서드**

```java
int read()                    // 1바이트 읽기
int read(byte[] b)            // 배열 크기만큼 읽기
int read(byte[] b, int off, int len) // 지정된 범위만큼 읽기
void close()                  // 스트림 닫기
```

**OutputStream의 주요 메서드**

```java
void write(int b)             // 1바이트 쓰기
void write(byte[] b)          // 배열 내용 쓰기
void write(byte[] b, int off, int len) // 지정된 범위 쓰기
void flush()                  // 버퍼 비우기
void close()                  // 스트림 닫기
```

**주요 바이트 스트림 클래스들**

- **FileInputStream/FileOutputStream**: 파일 입출력
- **ByteArrayInputStream/ByteArrayOutputStream**: 바이트 배열 입출력
- **DataInputStream/DataOutputStream**: 기본형 데이터 입출력
- **BufferedInputStream/BufferedOutputStream**: 버퍼링 제공

## 문자 기반 스트림

**Reader의 주요 메서드**

```java
int read()                    // 1문자 읽기
int read(char[] cbuf)         // 문자 배열에 읽기
String readLine()             // 한 줄 읽기 (BufferedReader)
void close()                  // 스트림 닫기
```

**Writer의 주요 메서드**

```java
void write(int c)             // 1문자 쓰기
void write(char[] cbuf)       // 문자 배열 쓰기
void write(String str)        // 문자열 쓰기
void flush()                  // 버퍼 비우기
void close()                  // 스트림 닫기
```

**주요 문자 스트림 클래스들**

- **FileReader/FileWriter**: 파일 입출력 (문자)
- **StringReader/StringWriter**: 문자열 입출력
- **BufferedReader/BufferedWriter**: 버퍼링 제공
- **PrintWriter**: 다양한 타입의 데이터를 문자로 출력

## 표준 입출력

**System 클래스의 입출력**

```java
System.in   // 표준 입력 (키보드) - InputStream
System.out  // 표준 출력 (모니터) - PrintStream
System.err  // 표준 에러 출력 - PrintStream
```

**표준 입출력 리다이렉션**

```java
System.setIn(InputStream in)    // 표준 입력 변경
System.setOut(PrintStream out)  // 표준 출력 변경
System.setErr(PrintStream err)  // 표준 에러 출력 변경
```

## 파일 입출력

**File 클래스**

```java
File file = new File("파일경로");
file.exists()        // 파일 존재 여부
file.isFile()        // 파일인지 확인
file.isDirectory()   // 디렉토리인지 확인
file.getName()       // 파일명 반환
file.getPath()       // 경로 반환
file.length()        // 파일 크기
file.delete()        // 파일 삭제
file.mkdir()         // 디렉토리 생성
```

**파일 읽기/쓰기 예제**

```java
// 텍스트 파일 읽기
BufferedReader br = new BufferedReader(new FileReader("file.txt"));
String line;
while((line = br.readLine()) != null) {
    System.out.println(line);
}
br.close();

// 텍스트 파일 쓰기
PrintWriter pw = new PrintWriter(new FileWriter("output.txt"));
pw.println("Hello World");
pw.close();
```

## 바이트 배열을 이용한 입출력

**ByteArrayInputStream/ByteArrayOutputStream**

- 메모리의 바이트 배열에 대한 입출력
- 주로 다른 곳에 입출력하기 전 메모리에서 작업할 때 사용

**StringReader/StringWriter**

- 문자열을 입출력 소스로 사용
- 메모리상의 문자열에 대한 작업

## 시퀀스 입력스트림

**SequenceInputStream**

- 여러 개의 입력스트림을 연결하여 하나의 스트림처럼 사용
- 여러 파일을 순차적으로 읽을 때 유용

```java
FileInputStream fis1 = new FileInputStream("file1.txt");
FileInputStream fis2 = new FileInputStream("file2.txt");
SequenceInputStream sis = new SequenceInputStream(fis1, fis2);
```

## 프린트 스트림

**PrintStream과 PrintWriter**

- 다양한 타입의 데이터를 문자로 출력
- printf(), println() 등의 편리한 메서드 제공
- PrintWriter는 문자 기반, PrintStream은 바이트 기반

```java
PrintWriter pw = new PrintWriter(System.out);
pw.printf("이름: %s, 나이: %d%n", "홍길동", 25);
```

## 객체 직렬화(Serialization)

**직렬화란**

- 객체를 데이터 스트림으로 만드는 것
- 객체의 상태를 저장하거나 네트워크로 전송할 때 사용

**Serializable 인터페이스**

```java
class Person implements Serializable {
    String name;
    int age;
    transient String password; // 직렬화 제외
}
```

**ObjectInputStream/ObjectOutputStream**

```java
// 객체 저장
ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream("object.dat"));
oos.writeObject(person);
oos.close();

// 객체 읽기
ObjectInputStream ois = new ObjectInputStream(new FileInputStream("object.dat"));
Person p = (Person)ois.readObject();
ois.close();
```

**serialVersionUID**

- 직렬화된 객체의 버전 관리를 위한 고유 ID
- 클래스 변경 시 호환성 문제 해결

## NIO (New Input/Output)

**기존 I/O의 단점과 NIO의 장점**

- **기존 I/O**: 블로킹, 스트림 지향
- **NIO**: 논블로킹, 채널과 버퍼 기반, 셀렉터 지원

**주요 NIO 구성요소**

- **Channel**: 양방향 통신 가능한 연결
- **Buffer**: 데이터를 담는 저장소
- **Selector**: 여러 채널을 관리

## 입출력 성능 향상 기법

**버퍼링**

- BufferedInputStream/BufferedOutputStream 사용
- 메모리 버퍼를 이용해 입출력 횟수 감소

**적절한 스트림 선택**

- 용도에 맞는 스트림 클래스 선택
- 처리 스트림을 활용한 기능 확장

**리소스 관리**

- try-with-resources 문 사용으로 자동 close()
- finally 블록에서 스트림 닫기

```java
// try-with-resources 예제
try (BufferedReader br = new BufferedReader(new FileReader("file.txt"))) {
    String line = br.readLine();
    // 자동으로 close() 호출됨
}
```
