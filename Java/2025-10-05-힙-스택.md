# 힙, 스택 (메모리 영역)

## 힙(Heap)이란?

**사전적 의미:**

- **Heap** = "쌓아올린 더미, 무더기"
- 데이터가 **무질서하게 쌓이는** 메모리 공간
- 필요할 때 **자유롭게 할당**하고 **자유롭게 해제**하는 영역

**특징:**

- 크기가 가변적: 런타임에 동적으로 할당 (고정된 최대치 내에서 탄력적으로 확장 가능)
- 관리 방식: 느슨함 (언제든 할당/해제 가능)
- 접근 속도: 스택과 비교해서 상대적으로 느림
- 생명주기: 명시적으로 해제하거나 GC가 회수할 때까지 유지

## 스택(Stack)이란?

**사전적 의미:**

- **Stack** = "차곡차곡 쌓은 더미"
- 데이터가 **순서대로 쌓이는** 메모리 공간
- **LIFO** (Last In First Out): 마지막에 넣은 게 먼저 나옴

**특징:**

- 크기가 **고정적**: 스레드 생성 시 크기 결정 (확장 불가)
- 관리 방식: 엄격함 (함수 호출/종료에 따라 자동 관리)
- 접근 속도: 매우 빠름
- 생명주기: 메서드 호출 시 생성, 메서드 종료 시 자동 소멸

### 시각적 비교

```
[스택 - Stack]
┌─────────────┐
│  method3()  │ ← 가장 최근 호출 (맨 위)
├─────────────┤
│  method2()  │
├─────────────┤
│  method1()  │
├─────────────┤
│   main()    │ ← 가장 먼저 호출 (맨 아래)
└─────────────┘
순서대로 쌓이고, 역순으로 제거됨


[힙 - Heap]
┌─────────────────────────┐
│ [객체A]  [객체C]          │
│      [객체B]             │
│          [배열D]         │
│                         │
│    [객체E]     [객체F]    │
└─────────────────────────┘
아무 곳에나 할당되고, GC가 정리함
```

### 힙과 스택이 나뉘어져 있는 이유

- **스택**은 **메서드 호출 흐름을 빠르게 관리**하고 **지역 변수의 생명주기를 자동으로 관리**하기 위해
- **힙**은 **크기를 예측할 수 없는 객체를 저장**하고 **여러 메서드/스레드에서 공유**해야 하는 데이터를 위해

### 코드로 이해하기

```java
public class MemoryExample {
    static int staticVar = 100;      // 메서드 영역 (static 영역)

    public static void main(String[] args) {
        int a = 10;                  // 스택: 기본형 변수
        String s = "hello";          // 스택: 참조 변수, 실제 객체는 힙
        Person p = new Person();     // 스택: 참조 변수 p, 힙: Person 객체

        method(a);                   // 스택에 새로운 프레임 생성
    }  // main 종료 → 스택의 a, s, p 제거 (하지만 힙의 객체는 남음)

    static void method(int param) {
        int local = 20;              // 스택: 지역 변수
        Person p2 = new Person();    // 스택: 참조 변수, 힙: Person 객체
    }  // method 종료 → param, local, p2 제거 (힙의 객체는 GC 대상)

    static class Person {
        int age = 25;
    }
}
```
